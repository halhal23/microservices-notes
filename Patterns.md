# マイクロサービスアーキテクチャのパターン言語まとめ

## アプリケーションパターン

- 分解
- データベースアーキテクチャ
- クエリー
- データ整合性維持
- テスト

## アプリケーションインフラストラクチャパターン

- 横断的関心事
- セキュリティ
- トランザクショナルメッセージング
- 通信スタイル
- 信頼性
- 可観測性

## インフラストラクチャパターン

- デプロイ
- ディスカバリ
- 外部 API

---

# 分解

[概要]

**Decompose by business capability** か **Decompose by subdomain**

[詳細]

**Decompose by business capability** は業務に対応してサービスを定義していく

**Decompose by subdomain** は DDD のサブドメインに対応してサービスを定義していく

↓ 具体的な分割 STEP 例

1. アプリケーションの要件を煮詰めて、主要なリクエストを抽出する
   1. 高水準ドメインオブジェクトを作成
   2. ドメインモデルに基づいてシステム操作を洗い出し、ふるまいを記述する
2. アプリケーションをどのように分割するか決める（business capability or subdomain）
3. 個々のサービスの API を決める

↓ 分割する上で重要な原則

- 単一責任の原則
- 閉鎖性共通の原則

↓ 分割する上で障害となるもの

- ネットワークレイテンシ
- 同期通信による可用性の低下
- サービス間でのデータ整合性の維持
- 整合性の取れたデータビュー
- 分割を妨害するゴッドクラス

# 通信スタイル

## 種類

HTTP ベースの**REST**や**gRPC**といったリクエスト/レスポンスベースの同期通信

**AMQP**や**STOMP**などのメッセージベースの非同期通信
